---
layout: bt_wiki
title: Creating Custom Widgets
category: Web Interface
draft: false
weight: 175
---

Cloudify enables you to create your own widgets, to assist you in orchestrating your applications in the Cloud.

Widgets can be written using two different methods.

* **Using the React Utility** is the recommended method, and requires a build operation to be executed. You can build the `_widget_.js` file yourself, or use the Cloudify build system.   

* **Pure Vanilla Java Script** which enables attachment of an HTML template file. The callbacks for this method are described later in this topic.

## Widget File Structure

A widget comprises a number of files, as described below.

* `widget.js` ‑ Holds the widget's definition (mandatory)
* `widget.png` ‑ The preview image of the widget (mandatory)
* `widget.html` ‑ A widget template file. Relevant only when you are writing a widget using vanilla JavaScript with an HTML template (optional)
* `widget.css` ‑ The CSS file that the widget uses (optional)

You place the widget in the widgets library, which must hold the ID of the widget. For example, if you are creating a blueprint (ID is `blueprint`), the blueprint library will be<br>
```/widgets   
   /blueprint   
      widget.js
      widget.html
      widget.png
      widget.css
```

To use the Cloudify build system, you must put your `_widget_.js` file into an `src` library, together with any other required files. In the `_widget_.js` file, you can use `import`to include the additional files. You can split the widget into a number of files. You can also use ES6 features.

Using this method, the file system will look as follows:
```/widgets   
   /blueprint   
      /src   
         widget.js
      widget.js  (generated by the build system)
      widget.html
      widget.png
      widget.css
```

### Defining the Widget

Each `_widget_.js` file must have a call to the `Stage.defineWidget` global function. The `Stage.defineWidget` function 

Option                 | Type    | Default | Description
----------             | -----   | ------- | -----------
`id`                   | string  | -       | The ID of the widget definition. Must match the name of the directory into which it is placed. **Mandatory**
`name`                 | string  | -       | The display name of the widget, which is displayed in the **Add Widget** dialog. It is also used as the default widget name in the widgets catalog. **Mandatory**
`description`          | string  | -       | Description of the widget that is displayed in the **Add Widget** dialog. Optional.
`initialWidth`         | string  | -       | The default width of the widget when added to a page. **Mandatory**
`initialHeight`        | string  | -       | The default height of the widget when added to a page. **Mandatory**
`color`                | string  | `red`   | The color of the widget. One of the following: `red`, `orange`, `yellow`, `olive`, `green`, `teal`, `blue`, `violet`, `purple`, `pink`, `brown`, `grey` or `black`
`showHeader`           | boolean | `true`  | Whether to display a header. If a header is not displayed, a user cannot change the widget name.
`isREact`              | boolean | `false` | Set as `true` when writing a React widget.
`fetchUrl`             | string/object | - | If `fetchUrl` exists, the data from the URL is fetched by the application and passed to the render and postRender methods. To fetch multiple URLs, you must pass an object where the key is a name you select for this data, and the value is the URL. It is important that the render is called once before the data is fetched (to enable information about loading or partial data can be displayed) and once after the data is fetched.
`initialConfiguration` | array   | -       | A list of widget configuration options. The options are displayed when a user clicks the ``**Configure** button on the widget in edit mode. It can also be accessed in the widget, to determine the current selected configuration.
`pageSize`             | integer | -       | The initital page size for widgets that support pagination.

#### Widget Functions
The following functions are available for widgets.

* **`init()`** Called when the widget definition is loaded, which occurs after the system is loaded. Can be used to define certain elements, for example classes and objects that will be used in the widget definition.
* **`render(widget, data, toolbox)`*** Called each time that the widget needs to draw itself. This might occur when the page is loaded, widget data is changed, context data is changed, widget data is feteched, and so on.   
   `render` parameters are:   
      * The widget object itself
      * The fetched data, either using `fetchUrl` or `fetchData`. The data is `null` if `fetchData` or `fetchUrl` is not specified. The data will also pass `null` to the `render` method until data is fetched. If you are expecting data, you can render a "loading" indicator.
      * The toolbox object.
* **`postRender(el, widget, data, toolbox) fetchData(widget, toolbox, fetchParams)`** 